# State tree pseudo-code
- Root
  - Auth
    - Status: LOGGED_IN/LOGGED_OUT/LOGGING_IN/LOG_IN_ERROR
        - Default: LOGGED_OUT
    - FUser
        - UID
        - Phone #
    - Error
        - Title
        - Message
        - Stacktrace/error obj
  - AppUser
    - Status: GETTING_USER/USER_READY/GET_USER_ERROR/USER_NOT_READY
        - Default: USER_NOT_READY
    - Role
    - Ministry ID

    - // TODO: really need to store contacts?
    - Share
        - Contacts:
            - Array({phone, name, contactId, currentStepIndex, currentStepDesc})
        - Stats:
            - // TODO
    - Admin
        - Stats:
            - // TODO
  - Share session
    - Status: STEPS_NOT_READY/GETTING_STEPS/STEPS_READY
    - Steps
    - Current step index

### Reducer pseudo-code
- Root = Auth + AppUser + ShareSession
- Auth
    - LOGGED_OUT => { ...state, user: null, status: LOGGED_OUT, error: null }
    - LOGGED_IN => { ...state, user: action.payload.user, status: LOGGED_IN, error: null}
    - LOGGING_IN => { ...state, user: null, status: LOGGING_IN, error: null }
    - ERROR => { ...state, user: null, status: ERROR, error: action.payload }
    - logIn => thunk => one of states
- AppUser
    - NOT_READY => { ...state, status: action.type, role: null, ministryId: null, share: null, admin: null }
    - GETTING_APP_USER => { ...state, status: action.type, role: null, ministryId: null, share: null, admin: null }
    - CONSTRUCTING_APP_USER => { ...state, newUser: action.payload }
    - SUBMITTING_APP_USER => { ...state, status: action.type, newUser: action.payload}
    - UPDATING_APP_USER => { ...state, status: action.type, role: action.payload.role, ministryId: action.payload.ministryId, share: action.payload.share, admin: action.payload.admin }
    - READY => { ...state, status: action.type, newUser: null, role: action.payload.role, ministryId: action.payload.ministryId, share: action.payload.share, admin: action.payload.admin }
    - ERROR => { ...state, status: action.type, error: action.payload}
    - createUser => thunk => CREATING_APP_USER => READY / ERROR
    - updateUser => thunk => UPDATING_APP_USER => READY / ERROR
    - fetchUser => thunk => GETTING_APP_USER => READY / ERROR
- ShareSession
    - NOT_READY => { ...state, status: action.type, steps: null, currentStepIndex: 0 }
    - GETTING_STEPS => { ...state, status: action.type, steps: null, currentStepIndex: 0 }
    - READY_TO_START => { ...state, status: READY, steps: action.payload.steps, currentStepIndex: action.payload, canGoBack: action.payload, canGoForward: action.payload }
    - SESSION_UPDATED => { ...state, status: READY, currentStepIndex: action.payload, canGoForward: action.payload, canGoBack: action.payload }
    - ERROR => { ...state, error: action.payload }
    - next() => thunk => increment step index, update can go back / forward => SESSION_UPDATED
    - back() => thunk => decrement step index, update can go back / forward
    - finish() => thunk => reset step index, can go back / forward => READY_TO_START

### Todo
- Building new user -- where to store state? (i.e. in midst of steps)